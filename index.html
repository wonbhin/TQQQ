<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì‚¬ë¦¬ì‚¬ìš• TQQQ ì•Œê³ ë¦¬ì¦˜ V13</title>
    <style>
        @import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css");

        :root {
            --bg-main: #09090b;
            --bg-card: #18181b;
            --border: #27272a;
            --text-main: #e4e4e7;
            --text-sub: #a1a1aa;
            
            --color-up: #34d399;
            --color-down: #f87171;
            --color-accent: #60a5fa;
            --color-gold: #fbbf24;
            
            --font-main: 'Pretendard', -apple-system, sans-serif;
            --font-mono: 'JetBrains Mono', 'Courier New', monospace; 
        }

        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-main);
            color: var(--text-main);
            font-family: var(--font-main);
            margin: 0;
            padding: 16px; /* ëª¨ë°”ì¼ ì—¬ë°± ì¡°ì • */
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container { width: 100%; max-width: 900px; display: grid; gap: 16px; }

        /* í°íŠ¸ ìœ í‹¸ë¦¬í‹° */
        .num-mono { font-family: var(--font-mono); font-weight: 700; letter-spacing: -0.5px; } 
        .num-clean { font-family: var(--font-main); font-weight: 700; letter-spacing: -0.2px; font-variant-numeric: tabular-nums; }
        .kor-bold { font-family: var(--font-main); font-weight: 800; letter-spacing: -0.5px; }
        
        .flex-between { display: flex; justify-content: space-between; align-items: center; }
        .text-sm { font-size: 0.85rem; color: var(--text-sub); }
        .text-xs { font-size: 0.75rem; color: var(--text-sub); }
        
        /* ì¹´ë“œ */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            position: relative;
            overflow: hidden;
            /* ê¸°ë³¸ì€ ì™¼ìª½ ì •ë ¬ ìœ ì§€ (PC) */
        }

        /* 1. í—¤ë” */
        .header-section {
            text-align: center;
            margin-bottom: 10px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 20px;
        }
        
        .quote-box {
            font-size: 1.2rem; /* ëª¨ë°”ì¼ ê³ ë ¤ ì‚¬ì´ì¦ˆ ì¡°ì • */
            font-weight: 800;
            color: #fff;
            min-height: 1.4em;
            background: linear-gradient(90deg, #fbbf24 0%, #f59e0b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 6px;
            display: inline-block;
            word-break: keep-all; /* ë‹¨ì–´ ë‹¨ìœ„ ì¤„ë°”ê¿ˆ */
        }

        .brand-sub {
            font-size: 0.85rem;
            color: var(--text-sub);
            font-weight: 500;
            opacity: 0.8;
            word-break: keep-all;
        }

        /* 2. ì§€í‘œ ê·¸ë¦¬ë“œ */
        .metrics-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
        .metric-label { font-size: 0.85rem; color: var(--text-sub); margin-bottom: 8px; display: block; font-weight: 500; }
        .metric-value { font-size: 1.6rem; font-weight: 700; color: #fff; }
        .metric-sub { font-size: 0.8rem; margin-top: 4px; display: flex; align-items: center; gap: 4px; }

        /* 3. ì¸í’‹ */
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .input-group { position: relative; }
        input[type="number"] {
            width: 100%; background: #000000; border: 1px solid var(--border);
            border-radius: 12px; padding: 16px 16px 16px 16px; /* íŒ¨ë”© ì¡°ì • */
            color: #fff; font-size: 1.1rem; font-weight: 700; text-align: right; font-family: var(--font-mono);
            -moz-appearance: textfield;
        }
        input[type="number"]::placeholder { color: #3f3f46; }
        input[type="number"]:focus { border-color: var(--color-accent); }
        .input-label { 
            display: block; font-size: 0.8rem; color: var(--text-sub); 
            margin-bottom: 6px; font-weight: 600; 
        }

        /* 4. ì§€ìˆ˜ ìƒíƒœ */
        .status-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .status-badge { font-size: 0.85rem; font-weight: 700; color: var(--text-main); background: #27272a; padding: 4px 10px; border-radius: 6px; }

        /* 5. ì „ëµ ê²°ê³¼ */
        .strategy-card { background: radial-gradient(circle at top right, rgba(255,255,255,0.03), transparent); border: 1px solid var(--border); }
        .strategy-title { font-size: 1.5rem; font-weight: 900; margin-top: 5px; color: #fff; word-break: keep-all; }
        .reasoning {
            background: rgba(63, 63, 70, 0.3); border-left: 3px solid var(--color-accent);
            padding: 15px; font-size: 0.95rem; line-height: 1.6; margin-bottom: 24px;
            border-radius: 0 8px 8px 0; color: #d4d4d8; word-break: keep-all;
        }
        .step-item {
            display: flex; align-items: center; background: rgba(255,255,255,0.02);
            padding: 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05); margin-bottom: 10px;
        }
        .step-icon {
            width: 32px; height: 32px; background: var(--border); border-radius: 8px; flex-shrink: 0;
            display: flex; align-items: center; justify-content: center; font-weight: 700; margin-right: 12px; color: var(--text-main);
        }
        .step-desc { font-size: 0.8rem; color: var(--text-sub); margin-bottom: 2px; }
        .step-val { font-size: 1.05rem; font-weight: 700; font-family: var(--font-main); }

        /* 6. ë§¤ë§¤ ì›ì¹™ */
        .rules-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .rule-item { background: rgba(255,255,255,0.02); padding: 16px; border-radius: 12px; border: 1px solid var(--border); }
        .rule-title { font-weight: 800; font-size: 1rem; margin-bottom: 10px; display:flex; align-items:center; gap:6px; }
        .rule-desc { font-size: 0.9rem; color: #a1a1aa; line-height: 1.6; word-break: keep-all; }
        .highlight-txt { color: var(--color-accent); font-weight: 800; }
        .highlight-gold { color: var(--color-gold); font-weight: 800; }
        
        /* 7. í…Œì´ë¸” */
        .wealth-table { width: 100%; border-collapse: separate; border-spacing: 0; }
        .wealth-table th { text-align: left; color: var(--text-sub); font-size: 0.8rem; padding-bottom: 12px; border-bottom: 1px solid var(--border); }
        .wealth-table td { padding: 16px 0; border-bottom: 1px solid #27272a55; font-size: 0.95rem; font-weight: 600; font-family: var(--font-main); }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        .cursor { display: inline-block; width: 3px; height: 1.2em; background-color: var(--color-gold); margin-left: 2px; animation: blink 1s step-end infinite; vertical-align: bottom; }
        @keyframes blink { 50% { opacity: 0; } }

        /* ìƒíƒœë³„ Glow */
        .glow-fear { box-shadow: 0 0 30px -10px rgba(52, 211, 153, 0.2); border-color: rgba(52, 211, 153, 0.5); }
        .glow-greed { box-shadow: 0 0 30px -10px rgba(248, 113, 113, 0.2); border-color: rgba(248, 113, 113, 0.5); }
        .glow-allin { box-shadow: 0 0 50px -10px rgba(251, 191, 36, 0.4); border-color: var(--color-gold); animation: borderPulse 2s infinite; }
        @keyframes borderPulse { 0% {border-color: var(--color-gold);} 50% {border-color: #f59e0b;} 100% {border-color: var(--color-gold);} }

        /* --- ğŸ“± ëª¨ë°”ì¼ ìµœì í™” (Mobile First Adjustments) --- */
        @media (max-width: 768px) {
            /* ê·¸ë¦¬ë“œ 1ì—´ë¡œ ë³€ê²½ */
            .metrics-grid, .input-grid, .status-grid, .rules-grid { grid-template-columns: 1fr; }
            
            /* ì¹´ë“œ ë‚´ë¶€ ê°€ìš´ë° ì •ë ¬ */
            .card {
                text-align: center; /* í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬ */
                display: flex;
                flex-direction: column;
                align-items: center; /* ì•„ì´í…œ ê°€ìš´ë° ì •ë ¬ */
                justify-content: center;
            }
            
            /* Flex-between ì¹´ë“œ (VIX, F&G, ì „ëµ í—¤ë”) êµ¬ì¡° ë³€ê²½ */
            .flex-between {
                flex-direction: column; /* ì„¸ë¡œ ë°°ì¹˜ */
                gap: 12px;
                text-align: center;
                width: 100%;
            }
            .flex-between > div {
                text-align: center !important;
                width: 100%;
            }

            /* ì¸í’‹ì°½ ìŠ¤íƒ€ì¼ ë³€ê²½ */
            .input-group { width: 100%; text-align: left; } /* ë¼ë²¨ì€ ì™¼ìª½ìœ¼ë¡œ */
            input[type="number"] { text-align: center; } /* ì…ë ¥ ìˆ«ìëŠ” ê°€ìš´ë° */

            /* ë©”íŠ¸ë¦­ìŠ¤ ì„œë¸Œ í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬ */
            .metric-sub { justify-content: center; }
            
            /* í…Œì´ë¸” í°íŠ¸ ì¡°ì • */
            .wealth-table th, .wealth-table td { text-align: center; } /* í…Œì´ë¸” ë‚´ìš© ê°€ìš´ë° */
            .wealth-table th:first-child, .wealth-table td:first-child { text-align: left; } /* ê¸°ê°„ì€ ì™¼ìª½ */
            
            /* ì „ëµ ì„¤ëª… ê°€ìš´ë° ì •ë ¬ */
            .reasoning { text-align: center; border-left: none; border-top: 3px solid var(--color-accent); border-radius: 8px; }
            
            /* ìŠ¤í… ì•„ì´í…œ */
            .step-item { flex-direction: column; text-align: center; gap: 8px; }
            .step-icon { margin-right: 0; margin-bottom: 4px; }
        }
        
        input[type="range"] { display: none; width: 100%; margin-top: 10px; accent-color: var(--text-sub); }
    </style>
</head>
<body>

<div class="container">
    
    <div class="header-section">
        <div class="quote-box">
            <span id="typewriter"></span><span class="cursor"></span>
        </div>
        <div class="brand-sub">ì‚¬ì‚¬ë¡œìš´ ì´ìµ(ç§åˆ©)ê³¼ ì‚¬ì‚¬ë¡œìš´ ìš•ì‹¬(ç§æ…¾)ì„ ì±„ìš°ëŠ” TQQQ ì•Œê³ ë¦¬ì¦˜</div>
    </div>

    <div class="metrics-grid">
        <div class="card">
            <span class="metric-label">TQQQ í˜„ì¬ê°€</span>
            <div class="metric-value num-mono" id="tqqqPrice">$0.00</div>
            <div class="metric-sub num-clean" id="tqqqChange">--%</div>
        </div>
        <div class="card">
            <span class="metric-label">ì›/ë‹¬ëŸ¬ í™˜ìœ¨</span>
            <div class="metric-value num-clean" id="exchRate">1,300</div>
            <div class="metric-sub text-xs">ì‹¤ì‹œê°„ ì ìš©</div>
        </div>
        <div class="card" style="background: rgba(59, 130, 246, 0.05); border-color: rgba(59, 130, 246, 0.2);">
            <span class="metric-label" style="color: var(--color-accent);">ì´ íˆ¬ì ê°€ëŠ¥ ê¸ˆì•¡</span>
            <div class="metric-value num-clean" style="color: var(--color-accent);" id="totalUsdDisp">$0.00</div>
            <div class="metric-sub text-xs">í™˜ì „ì•¡ + ì˜ˆìˆ˜ê¸ˆ í•©ì‚°</div>
        </div>
    </div>

    <div class="input-grid">
        <div class="input-group">
            <span class="input-label">ì´ë²ˆ ë‹¬ ì ë¦½ê¸ˆ (KRW)</span>
            <input type="number" id="inputKrw" placeholder="0">
        </div>
        <div class="input-group">
            <span class="input-label">ë³´ìœ  ì˜ˆìˆ˜ê¸ˆ (USD)</span>
            <input type="number" id="inputSaved" placeholder="0">
        </div>
    </div>

    <div class="status-grid">
        <div class="card flex-between">
            <div>
                <span class="metric-label">VIX ì§€ìˆ˜ (ê³µí¬)</span>
                <div class="num-mono" style="font-size: 1.6rem;" id="vixVal">--.--</div>
                <input type="range" id="vixSlider" min="10" max="80" value="20">
            </div>
            <div style="text-align: right;">
                <div id="vixBadge" class="status-badge">ë¡œë”©ì¤‘</div>
                <div class="text-xs" style="margin-top: 4px;">Volatility</div>
            </div>
        </div>
        <div class="card flex-between">
            <div>
                <span class="metric-label">ê³µí¬ íƒìš• ì§€ìˆ˜ (ì‹¬ë¦¬)</span>
                <div class="num-mono" style="font-size: 1.6rem;" id="fgVal">--</div>
                <input type="range" id="fgSlider" min="0" max="100" value="50">
            </div>
            <div style="text-align: right;">
                <div id="fgBadge" class="status-badge">ë¡œë”©ì¤‘</div>
                <div class="text-xs" style="margin-top: 4px;">Sentiment</div>
            </div>
        </div>
    </div>

    <div id="strategyCard" class="card strategy-card">
        <div class="flex-between" style="margin-bottom: 20px; border-bottom: 1px solid var(--border); padding-bottom: 15px; width:100%;">
            <div>
                <span class="text-sm" style="font-weight:700; color:#fff;">í˜„ì¬ ì‹¤í–‰ ì „ëµ (Action)</span>
                <div id="strategyTitle" class="strategy-title kor-bold">ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
            </div>
            <div id="strategyBadge" style="padding: 6px 12px; background: #27272a; border-radius: 8px; font-weight: bold; font-size: 0.85rem;">WAIT</div>
        </div>

        <div class="reasoning">
            <span style="opacity: 0.7; font-size: 0.8rem; display: block; margin-bottom: 6px; font-weight:800;">STRATEGY REASONING</span>
            <span id="strategyReason">ì ë¦½ê¸ˆê³¼ ì˜ˆìˆ˜ê¸ˆì„ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ì „ëµì´ ê³„ì‚°ë©ë‹ˆë‹¤.</span>
        </div>

        <div style="width:100%;">
            <div class="step-item">
                <div class="step-icon">1</div>
                <div>
                    <div class="step-desc">í™˜ì „ (Currency Exchange)</div>
                    <div id="actionStep1" class="step-val">ëŒ€ê¸° ì¤‘</div>
                </div>
            </div>
            <div class="step-item">
                <div class="step-icon">2</div>
                <div>
                    <div class="step-desc">ì£¼ë¬¸ (Buy Order)</div>
                    <div id="actionStep2" class="step-val">ëŒ€ê¸° ì¤‘</div>
                </div>
            </div>
            <div class="step-item">
                <div class="step-icon">3</div>
                <div>
                    <div class="step-desc">í™€ë”© (Cash Holding)</div>
                    <div id="actionStep3" class="step-val">ëŒ€ê¸° ì¤‘</div>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="flex-between" style="margin-bottom:15px; border-bottom:1px solid var(--border); padding-bottom:10px; width:100%;">
            <span class="text-sm" style="font-weight:700; color:var(--text-main);">ì‚¬ë¦¬ì‚¬ìš•(ç§åˆ©ç§æ…¾) ë§¤ë§¤ ì›ì¹™</span>
            <span class="text-xs">PROJECT: VIX-40</span>
        </div>
        <div class="rules-grid">
            <div class="rule-item">
                <div class="rule-title" style="color:#e4e4e7;">ğŸŸ¢ í‰ìƒì‹œ: ì‚¬ì‚¬ë¡œìš´ ì¤ì¤</div>
                <div class="rule-desc">
                    ë§¤ì›” ì ë¦½ê¸ˆì€ ë¬´ì¡°ê±´ <span class="highlight-txt">100% ë‹¬ëŸ¬ í™˜ì „</span>í•œë‹¤.<br>
                    ê³µí¬/íƒìš• ì§€ìˆ˜ì— ë”°ë¼ TQQQ ë¹„ì¤‘ì„ ì¡°ì ˆí•˜ë©° <span class="highlight-txt">ì‚¬ì‚¬ë¡­ê²Œ</span> ëª¨ì•„ê°„ë‹¤.<br>
                    <span style="font-size:0.8rem; opacity:0.7;">(íƒìš•ì—” í˜„ê¸ˆ ë¹„ì¶•, ê³µí¬ì—” ìš•ì‹¬ë‚´ì„œ ë§¤ìˆ˜)</span>
                </div>
            </div>
            <div class="rule-item" style="border-color: rgba(251, 191, 36, 0.3);">
                <div class="rule-title" style="color:var(--color-gold);">ğŸ”¥ ë¹„ìƒì‹œ: ì‚¬ë¦¬ì‚¬ìš• ì˜¬ì¸</div>
                <div class="rule-desc">
                    <span class="highlight-gold">VIX 40 ëŒíŒŒ</span> & <span class="highlight-gold">ê·¹ë‹¨ì  ê³µí¬</span> ì‹œ,<br>
                    ëª¨ì•„ë‘” <span class="highlight-gold">ë³´ìœ  ë‹¬ëŸ¬ ì „ì•¡</span>ì„ íˆ¬ì…í•˜ì—¬ ìš•ë§ì„ ì‹¤í˜„í•œë‹¤.<br>
                    <span style="font-size:0.8rem; opacity:0.7;">"ìœ„ê¸°ëŠ” ê³§ ë¶€ì˜ ì¶”ì›”ì°¨ì„ ì´ë‹¤."</span>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="flex-between" style="margin-bottom: 16px; width:100%;">
            <span class="metric-label" style="margin:0; font-size:1rem;">ë¯¸ë˜ ìì‚° ì‹œë®¬ë ˆì´ì…˜ (CAGR 30%)</span>
            <span class="text-xs">ë³´ìˆ˜ì  ê¸°ì¤€</span>
        </div>
        <table class="wealth-table">
            <thead>
                <tr>
                    <th>ê¸°ê°„</th>
                    <th>ì›ê¸ˆ</th>
                    <th>í‰ê°€ê¸ˆ</th>
                    <th>ìˆ˜ìµë¥ </th>
                </tr>
            </thead>
            <tbody id="wealthTable"></tbody>
        </table>
    </div>

</div>

<script>
    // --- ì•¼ìˆ˜ì˜ ëª…ì–¸ ---
    const quotes = [
        "\"ì‚¬ë¦¬ì‚¬ìš•(ç§åˆ©ç§æ…¾)ì€ ìë³¸ì£¼ì˜ì˜ ì›ë™ë ¥ì´ë‹¤.\"",
        "\"ì§€êµ¬ëŠ” ë©¸ë§í•˜ì§€ ì•ŠëŠ”ë‹¤. ì£¼ì›Œë¼.\"",
        "\"ë‚¨ë“¤ì´ ê³µí¬ì— ì§ˆë ¤ ë˜ì§ˆ ë•Œ, ë‚´ ìš•ì‹¬ì„ ì±„ìš´ë‹¤.\"",
        "\"í•˜ë½ì¥ì€ ë°”ê²ì„¸ì¼ ê¸°ê°„ì´ë‹¤. ì«„ì§€ ë§ê³  ì¦ê²¨ë¼.\"",
        "\"ì‹œì¥ì˜ íƒ€ì´ë°ì„ ë§ì¶”ë ¤ í•˜ì§€ ë§ê³  ì‹œì¥ì— ë¨¸ë¬¼ëŸ¬ë¼.\"",
        "\"ì•¼ìˆ˜ì˜ ì‹¬ì¥ìœ¼ë¡œ ë§¤ìˆ˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ë¼.\"",
        "\"ì¡´ë²„ëŠ” ìŠ¹ë¦¬í•œë‹¤. ì–´ì°¨í”¼ ìš°ìƒí–¥ì´ë‹¤.\"",
        "\"ë³€ë™ì„±ì€ ìœ„í—˜ì´ ì•„ë‹ˆë¼ ë¶€ìê°€ ë  ê¸°íšŒë‹¤.\"",
        "\"10ë…„ ë³´ìœ í•  ìƒê° ì•„ë‹ˆë©´ 10ë¶„ë„ ê°–ì§€ ë§ˆë¼.\"",
        "\"ì˜¤ëŠ˜ì˜ -3%ëŠ” 10ë…„ ë’¤ì˜ í‹°ëŒì´ë‹¤. ë¬´ì‹œí•´ë¼.\"",
        "\"ê³µí¬ì— ì‚¬ì„œ í™˜í¬ì— íŒ”ì•„ë¼. ê·¸ê²Œ ì „ë¶€ë‹¤.\""
    ];

    const textElement = document.getElementById('typewriter');
    const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
    let charIndex = 0;

    function typeWriter() {
        if (charIndex < randomQuote.length) {
            textElement.innerHTML += randomQuote.charAt(charIndex);
            charIndex++;
            setTimeout(typeWriter, 50);
        }
    }
    setTimeout(typeWriter, 500);

    // --- ë¡œì§ ---
    const state = { rate: 1300, tqqq: 0, vix: 20, fg: 50 };
    const el = {
        tqqqPrice: document.getElementById('tqqqPrice'),
        tqqqChange: document.getElementById('tqqqChange'),
        exchRate: document.getElementById('exchRate'),
        totalUsd: document.getElementById('totalUsdDisp'),
        krw: document.getElementById('inputKrw'),
        saved: document.getElementById('inputSaved'),
        vixVal: document.getElementById('vixVal'),
        vixBadge: document.getElementById('vixBadge'),
        vixSlider: document.getElementById('vixSlider'),
        fgVal: document.getElementById('fgVal'),
        fgBadge: document.getElementById('fgBadge'),
        fgSlider: document.getElementById('fgSlider'),
        stratCard: document.getElementById('strategyCard'),
        stratTitle: document.getElementById('strategyTitle'),
        stratBadge: document.getElementById('strategyBadge'),
        stratReason: document.getElementById('strategyReason'),
        step1: document.getElementById('actionStep1'),
        step2: document.getElementById('actionStep2'),
        step3: document.getElementById('actionStep3'),
        wealth: document.getElementById('wealthTable')
    };

    const fmt = n => n.toLocaleString();
    const fmtUsd = n => `$${n.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2})}`;

    async function updateData() {
        try {
            const res = await fetch('https://open.er-api.com/v6/latest/KRW');
            const data = await res.json();
            state.rate = 1 / data.rates.USD;
            el.exchRate.innerText = fmt(Math.round(state.rate));
        } catch(e) {}

        try {
            const target = encodeURIComponent('https://query1.finance.yahoo.com/v8/finance/chart/TQQQ?interval=1d&range=1d');
            const res = await fetch(`https://corsproxy.io/?${target}`);
            const json = await res.json();
            const meta = json.chart.result[0].meta;
            state.tqqq = meta.regularMarketPrice;
            const chg = ((state.tqqq - meta.chartPreviousClose) / meta.chartPreviousClose * 100);
            el.tqqqPrice.innerText = fmtUsd(state.tqqq);
            el.tqqqChange.innerText = `${chg>=0?'+':''}${chg.toFixed(2)}%`;
            el.tqqqChange.style.color = chg >= 0 ? 'var(--color-up)' : 'var(--color-down)';
        } catch(e) {
            if(state.tqqq===0) { state.tqqq=80.00; el.tqqqPrice.innerText="OFFLINE"; }
        }

        try {
            const target = encodeURIComponent('https://query1.finance.yahoo.com/v8/finance/chart/^VIX?interval=1d&range=1d');
            const res = await fetch(`https://corsproxy.io/?${target}`);
            const json = await res.json();
            state.vix = json.chart.result[0].meta.regularMarketPrice;
            el.vixSlider.style.display = 'none';
        } catch(e) {
            el.vixSlider.style.display = 'block';
            state.vix = Number(el.vixSlider.value);
        }

        try {
            const target = encodeURIComponent('https://production.dataviz.cnn.io/index/fearandgreed/graphdata');
            const res = await fetch(`https://corsproxy.io/?${target}`);
            const json = await res.json();
            state.fg = Math.round(json.fear_and_greed.score);
            el.fgSlider.style.display = 'none';
        } catch(e) {
            el.fgSlider.style.display = 'block';
            state.fg = Number(el.fgSlider.value);
        }

        render();
    }

    function render() {
        // ì¸í’‹ê°’ ì—†ìœ¼ë©´ 0ìœ¼ë¡œ ì²˜ë¦¬
        const krw = Number(el.krw.value) || 0;
        const saved = Number(el.saved.value) || 0;
        
        const monthlyUsd = krw / state.rate;
        const totalCap = monthlyUsd + saved;

        el.totalUsd.innerText = fmtUsd(totalCap);

        el.vixVal.innerText = state.vix.toFixed(2);
        let vixTxt = "ì•ˆì • (Stable)", vixCol = "var(--color-up)";
        if(state.vix>=40) { vixTxt="ğŸ”¥ ë©¸ë§ (DOOM)"; vixCol="var(--color-down)"; }
        else if(state.vix>=30) { vixTxt="ê³µí¬ (High Vol)"; vixCol="#fb923c"; }
        else if(state.vix>=20) { vixTxt="ë³€ë™ì„± (Volatile)"; vixCol="#fbbf24"; }
        el.vixBadge.innerText = vixTxt; el.vixBadge.style.color = vixCol;

        el.fgVal.innerText = state.fg;
        let fgTxt = "ì¤‘ë¦½ (Neutral)", fgCol = "#9ca3af";
        if(state.fg<=25) { fgTxt="ê·¹ë‹¨ì  ê³µí¬ (Fear)"; fgCol="var(--color-down)"; }
        else if(state.fg<=45) { fgTxt="ê³µí¬ (Fear)"; fgCol="#fb923c"; }
        else if(state.fg<=55) { fgTxt="ì¤‘ë¦½ (Neutral)"; fgCol="#9ca3af"; }
        else if(state.fg<=75) { fgTxt="íƒìš• (Greed)"; fgCol="#a3e635"; }
        else { fgTxt="ê·¹ë‹¨ì  íƒìš• (Greed)"; fgCol="var(--color-up)"; }
        el.fgBadge.innerText = fgTxt; el.fgBadge.style.color = fgCol;

        let ratio=0, mode="", reason="", cls="";
        
        if (state.vix >= 40 && state.fg <= 25) {
            ratio = 1.0; mode = "ì§€êµ¬ ë©¸ë§ ì˜¬ì¸"; cls = "glow-allin";
            reason = "ğŸš¨ VIX 40 ëŒíŒŒ + ê·¹ë‹¨ì  ê³µí¬ ê°ì§€!<br>ì‚¬ë¦¬ì‚¬ìš•ì„ ì±„ìš¸ ì ˆí˜¸ì˜ ê¸°íšŒì…ë‹ˆë‹¤.<br><strong>[ë³´ìœ  ë‹¬ëŸ¬ ì „ì•¡ íˆ¬ì…]</strong>í•˜ì—¬ ë°”ë‹¥ì„ ê¸ì–´ëª¨ìœ¼ì‹­ì‹œì˜¤.";
        } else if (state.fg <= 25) {
            ratio = 1.0; mode = "ì ê·¹ ì¤ì¤ (100%)"; cls = "glow-fear";
            reason = "âš¡ ê·¹ë‹¨ì  ê³µí¬ êµ¬ê°„ì…ë‹ˆë‹¤.<br>í™˜ì „í•œ <strong>ì ë¦½ê¸ˆì˜ 100%</strong>ë¥¼ ê³µê²©ì ìœ¼ë¡œ ë§¤ìˆ˜í•˜ì‹­ì‹œì˜¤. ì§€ê¸ˆ ì‚¬ì•¼ í‰ë‹¨ê°€ê°€ ë‚´ë ¤ê°‘ë‹ˆë‹¤.";
        } else if (state.fg <= 45) {
            ratio = 0.75; mode = "ë¶„í•  ì¤ì¤ (75%)"; cls = "glow-fear";
            reason = "ğŸ“‰ ê³µí¬ êµ¬ê°„ì…ë‹ˆë‹¤.<br><strong>ì ë¦½ê¸ˆì˜ 75%</strong>ë¥¼ ë§¤ìˆ˜í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ë” í° í•˜ë½ì— ëŒ€ë¹„í•´ í˜„ê¸ˆìœ¼ë¡œ ì±™ê²¨ë‘ì‹­ì‹œì˜¤.";
        } else if (state.fg <= 55) {
            ratio = 0.5; mode = "ì¤‘ë¦½ ë§¤ìˆ˜ (50%)";
            reason = "âš–ï¸ ì¤‘ë¦½ êµ¬ê°„ì…ë‹ˆë‹¤.<br>ë°©í–¥ì´ ë¶ˆí™•ì‹¤í•©ë‹ˆë‹¤. ê¸°ê³„ì ìœ¼ë¡œ <strong>ì ë¦½ê¸ˆì˜ ì ˆë°˜(50%)</strong>ë§Œ ë§¤ìˆ˜í•˜ê³  ê´€ë§í•˜ì‹­ì‹œì˜¤.";
        } else if (state.fg <= 75) {
            ratio = 0.25; mode = "ì†Œê·¹ì  ë§¤ìˆ˜ (25%)"; cls = "glow-greed";
            reason = "ğŸ“ˆ íƒìš• êµ¬ê°„ì…ë‹ˆë‹¤. ë¹„ìŒ‰ë‹ˆë‹¤.<br><strong>ì ë¦½ê¸ˆì˜ 25%</strong>ë§Œ ë§¤ìˆ˜í•˜ê³ , í˜„ê¸ˆì„ ë¹„ì¶•í•˜ì—¬ í­ë½ì¥ì„ ê¸°ë‹¤ë¦¬ì‹­ì‹œì˜¤.";
        } else {
            ratio = 0; mode = "ë§¤ìˆ˜ ì¤‘ë‹¨ (0%)"; cls = "glow-greed";
            reason = "ğŸ›‘ ê·¹ë‹¨ì  íƒìš• êµ¬ê°„ì…ë‹ˆë‹¤. ê³§ ì¡°ì •ì´ ì˜µë‹ˆë‹¤.<br>ë§¤ìˆ˜ë¥¼ ë©ˆì¶”ê³  í˜„ê¸ˆì„ 100% ë¹„ì¶•í•˜ì‹­ì‹œì˜¤.";
        }

        let buyUsd = monthlyUsd * ratio;
        if(state.vix >= 40 && state.fg <= 25) buyUsd = totalCap;

        const price = state.tqqq>0 ? state.tqqq : 1;
        const shares = Math.floor(buyUsd / price);
        const realBuy = shares * price;
        const remain = totalCap - realBuy;

        // ê°’ì´ ì—†ìœ¼ë©´ ëŒ€ê¸° ìƒíƒœ
        if(krw === 0 && saved === 0) {
            el.stratTitle.innerText = "ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”";
            el.stratBadge.innerText = "WAIT";
            el.stratBadge.style.color = "#fff";
            el.stratCard.className = "card strategy-card";
            el.stratReason.innerText = "ì ë¦½ê¸ˆê³¼ ì˜ˆìˆ˜ê¸ˆì„ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ì „ëµì´ ê³„ì‚°ë©ë‹ˆë‹¤.";
            el.step1.innerHTML = "ëŒ€ê¸° ì¤‘";
            el.step2.innerHTML = "ëŒ€ê¸° ì¤‘";
            el.step3.innerHTML = "ëŒ€ê¸° ì¤‘";
        } else {
            el.stratCard.className = `card strategy-card ${cls}`;
            el.stratTitle.innerText = `${shares}ì£¼ ë§¤ìˆ˜ ëª©í‘œ`;
            el.stratBadge.innerText = mode;
            el.stratBadge.style.color = cls.includes('fear') ? 'var(--color-up)' : (cls.includes('greed') ? 'var(--color-down)' : (cls.includes('allin')?'var(--color-gold)':'#fff'));
            el.stratReason.innerHTML = reason;

            el.step1.innerHTML = `<span class="num-clean" style="color:#fff">${fmt(krw)}</span>ì› â¡ <span class="kor-bold" style="color:var(--color-accent)">ì „ì•¡ í™˜ì „ (${fmtUsd(monthlyUsd)})</span>`;
            el.step2.innerHTML = `TQQQ <span class="kor-bold" style="color:var(--color-accent)">${shares}ì£¼</span> ì‹œì¥ê°€ ë§¤ìˆ˜ (ì•½ ${fmtUsd(realBuy)})`;
            el.step3.innerHTML = `ì”ì—¬ ì˜ˆìˆ˜ê¸ˆ <span class="kor-bold" style="color:var(--color-gold)">${fmtUsd(remain)}</span> í™€ë”©`;
        }

        const cagr = 0.30;
        let html = "";
        [3,5,10].forEach(y => {
            const m = y*12;
            const r = Math.pow(1+cagr, 1/12)-1;
            const fv = krw * (Math.pow(1+r, m)-1)/r;
            const inv = krw*m;
            const p = ((fv-inv)/inv*100).toFixed(0);
            html += `<tr><td>${y}ë…„ ë’¤</td><td class="num-clean">${fmt(inv)}ì›</td><td class="num-clean" style="color:#fff; font-weight:700;">${fmt(Math.round(fv))}ì›</td><td class="num-clean" style="color:var(--color-up)">+${p}%</td></tr>`;
        });
        el.wealth.innerHTML = html;
    }

    el.krw.addEventListener('input', render);
    el.saved.addEventListener('input', render);
    el.vixSlider.addEventListener('input', render);
    el.fgSlider.addEventListener('input', render);

    updateData();
    setInterval(updateData, 10000);
</script>
</body>
</html>
